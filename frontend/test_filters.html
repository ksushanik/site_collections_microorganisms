<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –°–ò–§–ò–ë–†</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-result { padding: 10px; margin: 5px 0; border-radius: 5px; }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        .info { background-color: #d1ecf1; color: #0c5460; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –°–ò–§–ò–ë–†</h1>
    
    <button onclick="testBasicLoad()">–¢–µ—Å—Ç 1: –ë–∞–∑–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞</button>
    <button onclick="testPsychrophileFilter()">–¢–µ—Å—Ç 2: –§–∏–ª—å—Ç—Ä –ø—Å–∏—Ö—Ä–æ—Ñ–∏–ª–æ–≤</button>
    <button onclick="testTemperatureFilter()">–¢–µ—Å—Ç 3: –§–∏–ª—å—Ç—Ä —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã</button>
    <button onclick="testCollectionFilter()">–¢–µ—Å—Ç 4: –§–∏–ª—å—Ç—Ä –∫–æ–ª–ª–µ–∫—Ü–∏–π</button>
    <button onclick="testCombinedFilter()">–¢–µ—Å—Ç 5: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã</button>
    
    <div id="results"></div>

    <script>
        const API_BASE = 'http://localhost:3000/api';
        
        function log(message, type = 'info') {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.innerHTML = `[${new Date().toLocaleTimeString()}] ${message}`;
            results.appendChild(div);
        }

        async function testBasicLoad() {
            try {
                log('üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —à—Ç–∞–º–º–æ–≤...');
                const response = await fetch(`${API_BASE}/strains/`);
                const data = await response.json();
                
                if (data.count > 0) {
                    log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${data.count} —à—Ç–∞–º–º–æ–≤`, 'success');
                    log(`üìä –ü–µ—Ä–≤—ã–π —à—Ç–∞–º–º: ${data.results[0].full_name} - ${data.results[0].scientific_name}`, 'info');
                } else {
                    log('‚ùå –®—Ç–∞–º–º—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã', 'error');
                }
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}`, 'error');
            }
        }

        async function testPsychrophileFilter() {
            try {
                log('üîÑ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ –ø—Å–∏—Ö—Ä–æ—Ñ–∏–ª–æ–≤...');
                const response = await fetch(`${API_BASE}/strains/`);
                const data = await response.json();
                
                const psychrophiles = data.results.filter(strain => strain.is_psychrophile === true);
                log(`‚úÖ –ù–∞–π–¥–µ–Ω–æ ${psychrophiles.length} –ø—Å–∏—Ö—Ä–æ—Ñ–∏–ª–æ–≤ –∏–∑ ${data.count}`, 'success');
                
                if (psychrophiles.length > 0) {
                    log(`üìä –ü—Ä–∏–º–µ—Ä: ${psychrophiles[0].full_name} (T: ${psychrophiles[0].optimal_temperature}¬∞C)`, 'info');
                }
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞ –ø—Å–∏—Ö—Ä–æ—Ñ–∏–ª–æ–≤: ${error.message}`, 'error');
            }
        }

        async function testTemperatureFilter() {
            try {
                log('üîÑ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã...');
                const response = await fetch(`${API_BASE}/strains/`);
                const data = await response.json();
                
                const lowTempStrains = data.results.filter(strain => 
                    strain.optimal_temperature && strain.optimal_temperature <= 10
                );
                log(`‚úÖ –ù–∞–π–¥–µ–Ω–æ ${lowTempStrains.length} —à—Ç–∞–º–º–æ–≤ —Å T ‚â§ 10¬∞C`, 'success');
                
                const highTempStrains = data.results.filter(strain => 
                    strain.optimal_temperature && strain.optimal_temperature >= 20
                );
                log(`‚úÖ –ù–∞–π–¥–µ–Ω–æ ${highTempStrains.length} —à—Ç–∞–º–º–æ–≤ —Å T ‚â• 20¬∞C`, 'success');
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã: ${error.message}`, 'error');
            }
        }

        async function testCollectionFilter() {
            try {
                log('üîÑ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–π...');
                const response = await fetch(`${API_BASE}/strains/`);
                const data = await response.json();
                
                const collections = {};
                data.results.forEach(strain => {
                    const code = strain.collection_code;
                    collections[code] = (collections[code] || 0) + 1;
                });
                
                log(`‚úÖ –ù–∞–π–¥–µ–Ω–æ ${Object.keys(collections).length} –∫–æ–ª–ª–µ–∫—Ü–∏–π:`, 'success');
                Object.entries(collections).forEach(([code, count]) => {
                    log(`   üìÅ ${code}: ${count} —à—Ç–∞–º–º–æ–≤`, 'info');
                });
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–π: ${error.message}`, 'error');
            }
        }

        async function testCombinedFilter() {
            try {
                log('üîÑ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤...');
                const response = await fetch(`${API_BASE}/strains/`);
                const data = await response.json();
                
                const combined = data.results.filter(strain => 
                    strain.is_psychrophile === true && 
                    strain.produces_antibiotics === true
                );
                
                log(`‚úÖ –ü—Å–∏—Ö—Ä–æ—Ñ–∏–ª—ã + –ø—Ä–æ–¥—É—Ü–µ–Ω—Ç—ã –∞–Ω—Ç–∏–±–∏–æ—Ç–∏–∫–æ–≤: ${combined.length} —à—Ç–∞–º–º–æ–≤`, 'success');
                
                const enzymeProducers = data.results.filter(strain => 
                    strain.produces_enzymes === true
                );
                
                log(`‚úÖ –ü—Ä–æ–¥—É—Ü–µ–Ω—Ç—ã —Ñ–µ—Ä–º–µ–Ω—Ç–æ–≤: ${enzymeProducers.length} —à—Ç–∞–º–º–æ–≤`, 'success');
                
                const withGenome = data.results.filter(strain => 
                    strain.has_genome_sequence === true
                );
                
                log(`‚úÖ –° —Å–µ–∫–≤–µ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –≥–µ–Ω–æ–º–æ–º: ${withGenome.length} —à—Ç–∞–º–º–æ–≤`, 'success');
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤: ${error.message}`, 'error');
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –±–∞–∑–æ–≤–æ–≥–æ —Ç–µ—Å—Ç–∞
        window.onload = () => {
            log('üöÄ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –°–ò–§–ò–ë–† –∑–∞–ø—É—â–µ–Ω–æ');
            testBasicLoad();
        };
    </script>
</body>
</html> 